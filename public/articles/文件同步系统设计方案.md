# æ–‡ä»¶åŒæ­¥ç³»ç»Ÿ
## ä¸€ã€æœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ–‡ä»¶åˆ°å®¢æˆ·ç«¯

**åœ¨æ–‡ä»¶åˆ†å‘ç³»ç»Ÿä¸­ï¼ŒæœåŠ¡ç«¯**å¯ä»¥**ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ–‡ä»¶**ï¼Œä¸è¿‡è¿™éœ€è¦æ»¡è¶³ä¸€å®šçš„æ¶æ„ä¸æŠ€æœ¯æ¡ä»¶ï¼Œä¸èƒ½å•é ä¼ ç»Ÿçš„ HTTP è¢«åŠ¨è¯·æ±‚æ¨¡å‹ã€‚

ä¸‹é¢æ˜¯å¸¸è§çš„å®ç°æ–¹å¼ã€åœºæ™¯ä¸æ³¨æ„äº‹é¡¹ã€‚

---

### æœåŠ¡ç«¯ä¸»åŠ¨æ¨é€çš„å…¸å‹å®ç°æ–¹å¼

| æŠ€æœ¯æ‰‹æ®µ                                  | æè¿°                         | é€‚ç”¨åœºæ™¯                 |
| ------------------------------------- | -------------------------- | -------------------- |
| **WebSocket / Socket.io**             | ä¿æŒå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„é•¿è¿æ¥ï¼ŒæœåŠ¡ç«¯å¯ä»¥å®æ—¶æ¨é€æ•°æ®  | Web å®¢æˆ·ç«¯éœ€è¦å®æ—¶æ¥æ”¶æ–‡ä»¶é€šçŸ¥æˆ–å†…å®¹ |
| **gRPC åŒå‘æµï¼ˆBidirectional Streamingï¼‰** | æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½å¯ä»¥ä¸»åŠ¨å‘é€æ¶ˆæ¯ï¼Œé€‚ç”¨äºå†…ç½‘ç³»ç»Ÿ   | åå°æœåŠ¡åŒæ­¥ã€ç»ˆç«¯ç®¡æ§ç³»ç»Ÿ        |
| **è‡ªå®šä¹‰ TCP åè®®**ï¼ˆå¦‚åŸºäº Nettyï¼‰             | å…¨æ§åˆ¶ã€æ— å»¶è¿Ÿæ¨é€                  | å¯¹ä¼ è¾“æ•ˆç‡è¦æ±‚æé«˜çš„ä¸“ç½‘ç³»ç»Ÿ       |
| **MQ + å®¢æˆ·ç«¯è½®è¯¢æ‹‰å–**                      | æœåŠ¡ç«¯å°†æ¨é€è¯·æ±‚å†™å…¥ MQï¼Œå®¢æˆ·ç«¯è®¢é˜…åæ‹‰å–å…·ä½“æ–‡ä»¶ | å¼‚æ­¥æ¨é€ï¼Œé¿å…é˜²ç«å¢™é™åˆ¶         |
| **P2P / Torrent æ¨¡å¼**                  | å¤šå®¢æˆ·ç«¯ä¹‹é—´ä¸»åŠ¨åä½œæ¨é€               | å¤§æ–‡ä»¶åˆ†å‘ã€å¤§é‡è®¾å¤‡éƒ¨ç½²         |

- **gRPC åŒå‘æµé€šä¿¡**

* ä¸€ä¸ªè¿æ¥åŒæ–¹éƒ½å¯ä»¥ä¸»åŠ¨å‘é€æ•°æ®æµï¼ˆå¦‚æ¨é€ã€æ‹‰å–ã€ç¡®è®¤ç­‰ï¼‰ã€‚
* ä½¿ç”¨åœºæ™¯ï¼šå†…ç½‘æ–‡ä»¶åŒæ­¥ã€ä»»åŠ¡åˆ†å‘ã€ç»ˆç«¯ç®¡æ§ã€‚

- **WebSocket åŒå‘é€šä¿¡**

* é€‚åˆæµè§ˆå™¨æˆ–æ¡Œé¢å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡ï¼Œä¿æŒè¿æ¥åå¯äº’ç›¸å‘æ¶ˆæ¯å’Œæ–‡ä»¶æŒ‡ä»¤ã€‚

- **Netty / TCP è‡ªå®šä¹‰åè®®**

* å…¨æ§åˆ¶ï¼Œé€‚åˆæ„å»ºé«˜æ€§èƒ½ç³»ç»Ÿã€‚
* å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä½œä¸ºç›‘å¬æ–¹å’Œè¿æ¥æ–¹ï¼Œæ”¯æŒåŒå‘æ–‡ä»¶ä¼ è¾“ã€‚

- **REST åŒå‘æœåŠ¡ç«¯ç‚¹**

* æ¯ä¸ªèŠ‚ç‚¹éƒ½æä¾› HTTP æ¥å£ã€‚
* A é€šè¿‡ HTTP POST å‘é€æ–‡ä»¶ç»™ Bï¼Œåä¹‹äº¦ç„¶ã€‚
* ç¼ºç‚¹ï¼šæ— æ³•å®æ—¶æ¨é€ï¼Œéœ€è¦è½®è¯¢æˆ–é¢å¤–é€šé“é€šçŸ¥ã€‚

* ä½ éœ€è¦æ³¨æ„çš„é—®é¢˜

1. **å®¢æˆ·ç«¯å¿…é¡»åœ¨çº¿ã€å¯è¿æ¥**ï¼šæœåŠ¡ç«¯æ— æ³•ä¸»åŠ¨è”ç³»ä¸€ä¸ªå®Œå…¨â€œç¦»çº¿â€çš„å®¢æˆ·ç«¯ã€‚
2. **é˜²ç«å¢™ / NAT ç©¿é€é—®é¢˜**ï¼šå¦‚æœå®¢æˆ·ç«¯å¤„äºå…¬ç½‘åæˆ– NAT åé¢ï¼ŒæœåŠ¡ç«¯éœ€è¦å®¢æˆ·ç«¯å…ˆå»ºç«‹è¿æ¥ï¼ˆæ¯”å¦‚ WebSocketã€gRPC Streamï¼‰ï¼ŒæœåŠ¡ç«¯æ‰èƒ½æ¨ã€‚
3. **æ¨é€ä¸æ˜¯å¹¿æ’­**ï¼šå¿…é¡»çŸ¥é“å®¢æˆ·ç«¯æ˜¯è°ã€è¿æ¥åœ¨å“ªä¸ª session ä¸Šã€‚
4. **å®‰å…¨æœºåˆ¶**ï¼šéœ€éªŒè¯æ¨é€è¯·æ±‚åˆæ³•æ€§ï¼Œé˜²æ­¢éæ³•æ–‡ä»¶æ³¨å…¥ã€‚
5. **æ–­ç‚¹ç»­ä¼ ä¸å»é‡**ï¼šæ¨é€ç³»ç»Ÿä¸­å»ºè®®å¸¦ä¸Š chunk æ ¡éªŒã€MD5 æ¯”å¯¹ç­‰æœºåˆ¶ã€‚

**ç¤ºä¾‹åœºæ™¯**

1. **å†…ç½‘è½¯ä»¶è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿ**
   åå°æœåŠ¡æ£€æµ‹åˆ°æ›´æ–°ç‰ˆæœ¬ï¼Œä¸»åŠ¨æ¨é€åˆ°å„å®¢æˆ·ç«¯ï¼Œæ— éœ€å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ã€‚

2. **æ™ºèƒ½ç”µè¡¨ã€IoT è®¾å¤‡å›ºä»¶å‡çº§**
   æœåŠ¡ç«¯é€šè¿‡é•¿è¿æ¥ä¸»åŠ¨å‘é€æ›´æ–°æŒ‡ä»¤å’Œå›ºä»¶åŒ…ã€‚

3. **gRPC æ–‡ä»¶åŒæ­¥ç³»ç»Ÿ**
   æœåŠ¡ç«¯é€šè¿‡åŒå‘æµå¼ gRPC é€šçŸ¥å®¢æˆ·ç«¯éœ€è¦æ›´æ–°å“ªäº›æ–‡ä»¶ï¼Œå¹¶é€å—æ¨é€ã€‚


è€ƒè™‘åˆ°å®ç°çš„å¤æ‚æ€§å’Œå°½é‡æé«˜ä¼ è¾“é€Ÿåº¦ï¼Œè¿™é‡Œé€‰æ‹©ä½¿ç”¨ **gRPC åŒå‘æµ** ä½œä¸ºæœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ–‡ä»¶çš„ä¸»è¦æ–¹å¼ã€‚

## äºŒã€gRPC æ–‡ä»¶ä¼ è¾“è®¾è®¡
### 1. åˆ†å¸ƒå¼ gRPC ä¸»åŠ¨æ¨é€é€šä¿¡æ¶æ„å›¾
ä¸‹é¢æ˜¯ä¸€ä»½é€‚ç”¨äº **åˆ†å¸ƒå¼ gRPC æœåŠ¡ç«¯ä¸»åŠ¨æ¨é€å®¢æˆ·ç«¯** çš„å…¸å‹é€šä¿¡æ¶æ„æµç¨‹å›¾ï¼ŒåŒ…å«è¿æ¥æ³¨å†Œã€æ¶ˆæ¯æ¨é€ã€æ¶ˆæ¯è½¬å‘ç­‰æ ¸å¿ƒæµç¨‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      å®¢æˆ·ç«¯ ClientA â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ å»ºç«‹åŒå‘æµè¿æ¥
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   gRPC å®ä¾‹èŠ‚ç‚¹ Aï¼ˆgrpc-server-1ï¼‰ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ StreamObserver<ClientA>      â”‚  â”‚
â”‚ â”‚ æ³¨å†Œè¿æ¥:                     â”‚  â”‚
â”‚ â”‚ Redis.set("clientA", {       â”‚  â”‚
â”‚ â”‚   node: "grpc-server-1",     â”‚  â”‚
â”‚ â”‚   time: "2025-08-01T16:00"   â”‚  â”‚
â”‚ â”‚ })                           â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€”â”€â”€â”€â”€â”˜
                 â”‚
         â–¼ Redis å…±äº«è¿æ¥æ³¨å†Œä¸­å¿ƒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Redis                â”‚
â”‚  clientA => { node: grpc-server-1 }â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–²
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ gRPC å®ä¾‹èŠ‚ç‚¹ Bâ”‚   â”‚    åå°ä¸šåŠ¡æ¨¡å—  â”‚
â”‚ grpc-server-2  â”‚   â”‚ ï¼ˆå‘èµ·æ¨é€æ“ä½œï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                       å‘èµ·æ¨é€è¯·æ±‚
                              â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ æŸ¥ Redis: clientA å±äºAèŠ‚ç‚¹ â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                   æ˜¯æˆ‘è‡ªå·±ï¼Ÿå¦ â”€â”€â”€â”€â”€â”€â–º æ˜¯
                            â”‚             â”‚
                            â–¼             â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ RPC è°ƒç”¨èŠ‚ç‚¹A      â”‚  â”‚ è·å– StreamObserverâ”‚
                  â”‚ /push(clientA, msg)â”‚  â”‚ observer.onNext()  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                  èŠ‚ç‚¹A æ‰§è¡Œ observer.onNext()
```

---

- æ ¸å¿ƒç»„ä»¶è¯´æ˜

| ç»„ä»¶               | ä½œç”¨                              |
| ---------------- | ------------------------------- |
| **å®¢æˆ·ç«¯**          | ä¸æŸä¸ª gRPC èŠ‚ç‚¹å»ºç«‹æµå¼è¿æ¥ï¼ŒæœåŠ¡ç«¯å¯ä»¥å‘å®ƒæ¨é€æ•°æ®   |
| **gRPC èŠ‚ç‚¹ï¼ˆA/Bï¼‰** | éƒ¨ç½²å¤šä¸ªå‰¯æœ¬ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªç®¡ç†è¿æ¥åˆ°å®ƒçš„å®¢æˆ·ç«¯          |
| **Redis / etcd** | å­˜å‚¨æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥æ‰€å±èŠ‚ç‚¹ï¼ˆç”¨äºè·¯ç”±ï¼‰             |
| **åå°ä¸šåŠ¡æ¨¡å—**       | å‘èµ·æ¨é€åŠ¨ä½œï¼Œä¸å…³å¿ƒè¿æ¥åœ¨å“ªä¸ªèŠ‚ç‚¹               |
| **æ¨é€è°ƒåº¦é€»è¾‘**       | æŸ¥è¯¢å®¢æˆ·ç«¯æ‰€åœ¨èŠ‚ç‚¹ â†’ æœ¬åœ°æ¨é€æˆ–è¿œç¨‹è°ƒç”¨ gRPC æ¨é€æ¥å£ |


- æ•°æ®ç»“æ„ç¤ºä¾‹ï¼ˆå­˜å…¥ Redisï¼‰ï¼š

```json
client:clientA {
  "node": "grpc-server-1",
  "sessionId": "uuid-xxx",
  "lastActive": "2025-08-01T16:00:00"
}
```

**è¿™ç§æ¶æ„å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š**

* **æ”¯æŒåˆ†å¸ƒå¼å¤šèŠ‚ç‚¹éƒ¨ç½²**
* **æœåŠ¡ç«¯å¯å¯¹å®¢æˆ·ç«¯è¿›è¡Œä¸»åŠ¨æ¶ˆæ¯/æ–‡ä»¶æ¨é€**
* **å®¢æˆ·ç«¯è¿æ¥å¯é€šè¿‡ Redis å¿«é€Ÿè·¯ç”±å®šä½**
* **ä¸éœ€è¦é›†ä¸­å¼è¿æ¥è½¬å‘å™¨ï¼ˆå¦‚ IM ç½‘å…³ï¼‰**

---

å¦‚æœ **gRPC æœåŠ¡ç«¯æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„**ï¼ˆå³å¤šä¸ªæœåŠ¡å‰¯æœ¬/èŠ‚ç‚¹å¯èƒ½éƒ¨ç½²åœ¨ Kubernetesã€ECSã€Docker Swarm ç­‰ç¯å¢ƒä¸­ï¼‰ï¼Œé‚£ä¹ˆè¿æ¥ç®¡ç†å˜å¾—å¤æ‚ä¸€äº›ï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹é—®é¢˜ï¼š

æ ¸å¿ƒæŒ‘æˆ˜ï¼šåˆ†å¸ƒå¼æœåŠ¡å¦‚ä½•ç®¡ç†å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ
---
| é—®é¢˜      | æè¿°                          |
| ------- | --------------------------- |
| å¤šèŠ‚ç‚¹è¿æ¥éš”ç¦» | å®¢æˆ·ç«¯è¿æ¥çš„æ˜¯æŸä¸ªèŠ‚ç‚¹ï¼Œè¿æ¥çŠ¶æ€åªä¿å­˜åœ¨è¯¥èŠ‚ç‚¹å†…å­˜ä¸­  |
| æ¨é€è·¯å¾„ä¸æ˜ç¡® | æŸä¸ªæœåŠ¡èŠ‚ç‚¹ä¸çŸ¥é“å®¢æˆ·ç«¯è¿åˆ°äº†å“ªä¸ªå®ä¾‹         |
| ä¸»åŠ¨æ¨é€å¤±æ•ˆ  | å¦‚æœæœåŠ¡ç«¯ A æƒ³æ¨é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œä½†å®¢æˆ·ç«¯è¿æ¥åœ¨ B |
| çŠ¶æ€ä¸€è‡´æ€§é—®é¢˜ | å„èŠ‚ç‚¹æ— æ³•å…±äº«è¿æ¥çŠ¶æ€ï¼Œæ— æ³•å¹¿æ’­ã€æ–­ç‚¹ç»­ä¼ ç­‰æ“ä½œ    |

 è§£å†³æ–¹æ¡ˆæ±‡æ€»

| æ–¹æ¡ˆ                      | æè¿°                                      | é€‚ç”¨               |
| ----------------------- | --------------------------------------- | ---------------- |
|  1. å®¢æˆ·ç«¯è¿æ¥å›ºå®šèŠ‚ç‚¹ï¼ˆé»æ€§è¿æ¥ï¼‰     | åŸºäºè´Ÿè½½å‡è¡¡ç­–ç•¥å¦‚ `ip_hash` è®©å®¢æˆ·ç«¯å§‹ç»ˆè¿åŒä¸€ä¸ª gRPC å®ä¾‹  | å°‘é‡å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å›ºå®šéƒ¨ç½²     |
|  2. Redis / etcd å…±äº«è¿æ¥æ³¨å†Œè¡¨ | æ‰€æœ‰èŠ‚ç‚¹å…±äº«ä¸€ä¸ªè¿æ¥å…ƒä¿¡æ¯å­˜å‚¨ï¼ˆä½†ä¸èƒ½å…±äº« `StreamObserver`ï¼‰ | æ³¨å†Œæ¨é€æ¶ˆæ¯è·¯å¾„ã€çŠ¶æ€å…±äº«    |
|  3. ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶ä¸­è½¬æ¨é€ï¼ˆæ¨èï¼‰     | æœåŠ¡ç«¯æ¨é€æ¶ˆæ¯æ—¶é€šè¿‡ MQï¼ˆå¦‚ Kafkaã€RabbitMQï¼‰è½¬å‘ç»™æ­£ç¡®èŠ‚ç‚¹  | å®¢æˆ·ç«¯æ•°é‡å¤šï¼Œæ¨é€å®æ—¶æ€§è¦æ±‚ä¸­ç­‰ |
|  4. ä½¿ç”¨ç»Ÿä¸€ä¸­è½¬ç½‘å…³ï¼ˆä¾‹å¦‚é•¿è¿æ¥è½¬å‘ä¸­å¿ƒï¼‰ | å®¢æˆ·ç«¯ç»Ÿä¸€æ¥å…¥ä¸€ä¸ªç½‘å…³èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ä¸åç«¯æœåŠ¡è½¬å‘æ•°æ®              | IoTã€IM ç­‰é«˜å¹¶å‘ç³»ç»Ÿ    |
|  5. ä½¿ç”¨æœåŠ¡æ³¨å†Œ + èŠ‚ç‚¹é—´ RPC è°ƒç”¨ | A èŠ‚ç‚¹æ— æ³•æ‰¾åˆ°å®¢æˆ·ç«¯è¿æ¥æ—¶ï¼Œè°ƒç”¨ B èŠ‚ç‚¹çš„ gRPC æ¨é€æœåŠ¡       | èŠ‚ç‚¹æ•°é‡æœ‰é™ï¼Œå¼ºä¸€è‡´æ¨é€éœ€æ±‚   |

---

### 2 æ–¹æ¡ˆè¯¦è§£ï¼šæœåŠ¡ç«¯åˆ†å¸ƒå¼ä¸‹çš„è¿æ¥ç®¡ç†ï¼ˆæ¨é€ï¼‰


 1. å®¢æˆ·ç«¯è¿æ¥ä¸æ³¨å†Œæµç¨‹

> å®¢æˆ·ç«¯è¿æ¥ä»»æ„æœåŠ¡èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹å°†å…¶è¿æ¥ä¿¡æ¯æ³¨å†Œåˆ° Redis ç­‰å…±äº«æ³¨å†Œä¸­å¿ƒï¼š

```json
client_sessions:
  clientA -> {
      "connectedTo": "grpc-server-1",
      "lastActive": "2025-08-01T16:15:00",
      "sessionId": "uuid"
  }
```

 2. æœåŠ¡ç«¯æ¨é€æµç¨‹ï¼ˆä¸»åŠ¨æ¨é€ï¼‰

å½“ä½ æƒ³ä»æœåŠ¡ç«¯å‘æŸä¸ªå®¢æˆ·ç«¯æ¨é€æ•°æ®æ—¶ï¼š

 - A. æŸ¥ Redis è·å– clientId æ‰€å±çš„æœåŠ¡èŠ‚ç‚¹ï¼š

```java
String nodeId = redis.get("client:clientA:connectedTo");
```

- B. åˆ¤æ–­æœ¬èŠ‚ç‚¹æ˜¯å¦æŒæœ‰è¿æ¥ï¼š

  * å¦‚æœæ˜¯æœ¬èŠ‚ç‚¹ï¼Œç›´æ¥ä»å†…å­˜ä¸­å–å‡º `StreamObserver`ï¼Œè°ƒç”¨ `onNext()`
  * å¦‚æœä¸æ˜¯ï¼Œèµ° **RPC** æˆ– **æ¶ˆæ¯ä¸­é—´ä»¶** è½¬å‘

 3. ä½¿ç”¨ Kafka æˆ– Redis Stream ä¸­è½¬æ¨é€ï¼ˆæ¨èï¼‰

å„æœåŠ¡èŠ‚ç‚¹å¯åŠ¨ç›‘å¬ä»»åŠ¡ï¼Œä» MQ ä¸­ç›‘å¬â€œå±äºè‡ªå·±èŠ‚ç‚¹çš„æ¨é€æ¶ˆæ¯â€ï¼š

```json
topic: client-push
message:
  {
    "targetClientId": "clientA",
    "connectedNode": "grpc-server-2",
    "payload": { ... }
  }
```

æ¯ä¸ªèŠ‚ç‚¹åªå¤„ç†å‘å¾€è‡ªå·±çš„ clientIdï¼Œæ‰¾å‡ºå¯¹åº”çš„è¿æ¥ï¼Œ`onNext()` å‘é€ã€‚

---

4. å¾®æœåŠ¡ä¸­çš„èŠ‚ç‚¹é—´é€šä¿¡ï¼ˆæœåŠ¡é—´ RPCï¼‰

å¦‚æœä½ ä¸å¸Œæœ›å¼•å…¥ MQï¼Œä¹Ÿå¯ä»¥è®©èŠ‚ç‚¹ä¹‹é—´äº’ç›¸è°ƒç”¨ `grpc://nodeX/push` æ¥å£ï¼š

```java
@GrpcClient("grpc-server-node-2")
private PushServiceGrpc.PushServiceBlockingStub pushStub;

// æœåŠ¡ A æ‰¾åˆ° client åœ¨ Bï¼Œå°±è½¬å‘æ¨é€
pushStub.pushToClient(PushRequest.newBuilder()
    .setClientId("clientA")
    .setPayload(...)
    .build());
```

## åˆ†å¸ƒå¼ gRPC æœåŠ¡è¿æ¥ç®¡ç†ç­–ç•¥

| ç›®æ ‡     | å»ºè®®åšæ³•                                        |
| ------ | ------------------------------------------- |
| æ³¨å†Œè¿æ¥   | æœ¬åœ°å†…å­˜ä¿å­˜ `StreamObserver`ï¼Œå…ƒæ•°æ®æ³¨å†Œ Redis         |
| ä¸»åŠ¨æ¨é€   | æŸ¥è¯¢è¿æ¥æ³¨å†Œè¡¨ â†’ å¦‚æœä¸æ˜¯æœ¬èŠ‚ç‚¹ â†’ å‘ MQ / RPC ä¼ é€’           |
| çŠ¶æ€å…±äº«   | Redis / etcd å…±äº«è¿æ¥çŠ¶æ€ï¼Œè®¾ç½® TTL é˜²æ­¢è„æ•°æ®            |
| èŠ‚ç‚¹é—´é€šä¿¡  | ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶ä¸­è½¬æˆ– gRPC æœåŠ¡ä¹‹é—´äº’è°ƒ                      |
| ä¿è¯ç¨³å®šè¿æ¥ | å¯ä»¥é€šè¿‡ ip\_hash / Envoy session stickiness å®ç° |

æ ¸å¿ƒæ¶æ„ä»£ç 
---

```proto
// ========== proto æ–‡ä»¶å®šä¹‰ ==========
// file: push.proto
syntax = "proto3";

option java_package = "com.example.push.grpc";
option java_multiple_files = true;

service PushService {
  // å®¢æˆ·ç«¯å»ºç«‹åŒå‘è¿æ¥
  rpc Connect(stream ClientMessage) returns (stream ServerMessage);

  // èŠ‚ç‚¹ä¹‹é—´è°ƒç”¨ï¼Œæ¨é€æ¶ˆæ¯ç»™æŒ‡å®šå®¢æˆ·ç«¯
  rpc PushToClient(PushRequest) returns (PushResponse);
}

message ClientMessage {
  oneof payload {
    RegisterRequest register = 1;
    Heartbeat heartbeat = 2;
  }
}

message RegisterRequest {
  string client_id = 1;
}

message Heartbeat {
  string client_id = 1;
  int64 timestamp = 2;
}

message ServerMessage {
  oneof payload {
    string message = 1;
    FileNotice file_notice = 2;
  }
}

message FileNotice {
  string file_name = 1;
  int64 file_size = 2;
  string file_id = 3;
}

message PushRequest {
  string client_id = 1;
  string message = 2;
}

message PushResponse {
  bool success = 1;
  string error = 2;
}

// ========== æ–°å¢ proto æ–‡ä»¶å®šä¹‰ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰ ==========
// file: file_transfer.proto
syntax = "proto3";

option java_package = "com.example.push.grpc";
option java_multiple_files = true;

service FileService {
  rpc DownloadFile(FileRequest) returns (stream FileChunk);
}

message FileRequest {
  string file_id = 1;
}

message FileChunk {
  bytes content = 1;
  int32 sequence = 2;
  bool is_last = 3;
}
```

FileServiceImpl
```Java
// ========== æ–‡ä»¶æœåŠ¡ç«¯å®ç° ==========
@GrpcService
public class FileServiceImpl extends FileServiceGrpc.FileServiceImplBase {

    @Override
    public void downloadFile(FileRequest request, StreamObserver<FileChunk> responseObserver) {
        String fileId = request.getFileId();
        File file = new File("./files/" + fileId); // å‡è®¾ file_id å³æ–‡ä»¶å
        int bufferSize = 64 * 1024;

        try (InputStream in = new FileInputStream(file)) {
            byte[] buffer = new byte[bufferSize];
            int read;
            int sequence = 0;

            while ((read = in.read(buffer)) != -1) {
                FileChunk chunk = FileChunk.newBuilder()
                        .setContent(ByteString.copyFrom(buffer, 0, read))
                        .setSequence(sequence++)
                        .setIsLast(false)
                        .build();
                responseObserver.onNext(chunk);
            }

            responseObserver.onNext(FileChunk.newBuilder()
                    .setIsLast(true)
                    .setSequence(sequence)
                    .build());

            responseObserver.onCompleted();
        } catch (IOException e) {
            responseObserver.onError(Status.INTERNAL.withDescription("Read failed").asRuntimeException());
        }
    }
}
```
FileClient
```java
// ========== Java å®¢æˆ·ç«¯ä¸‹è½½æ–‡ä»¶ ==========
public class FileClient {

    private final FileServiceGrpc.FileServiceStub stub;

    public FileClient(ManagedChannel channel) {
        this.stub = FileServiceGrpc.newStub(channel);
    }

    public void downloadFile(String fileId, String outputPath) {
        FileRequest request = FileRequest.newBuilder().setFileId(fileId).build();
        File outputFile = new File(outputPath);

        stub.downloadFile(request, new StreamObserver<>() {
            try (OutputStream out = new FileOutputStream(outputFile)) {
                @Override
                public void onNext(FileChunk chunk) {
                    try {
                        if (chunk.hasContent()) {
                            out.write(chunk.getContent().toByteArray());
                        }
                        if (chunk.getIsLast()) {
                            out.flush();
                            System.out.println("File download complete: " + outputPath);
                        }
                    } catch (IOException e) {
                        System.err.println("Write failed: " + e.getMessage());
                    }
                }

                @Override
                public void onError(Throwable t) {
                    System.err.println("Download failed: " + t.getMessage());
                }

                @Override
                public void onCompleted() {
                    System.out.println("Stream closed by server");
                }
            } catch (IOException e) {
                System.err.println("Failed to open output file: " + e.getMessage());
            }
        });
    }

    public static void main(String[] args) {
        ManagedChannel channel = ManagedChannelBuilder.forAddress("localhost", 6565).usePlaintext().build();
        FileClient client = new FileClient(channel);
        client.downloadFile("test.pdf", "./downloaded_test.pdf");
    }
}

```



æ˜¯çš„ï¼Œä½ çš„ç†è§£å®Œå…¨æ­£ç¡®ï¼Œä¸‹é¢æ˜¯æ›´è¯¦ç»†çš„è¯´æ˜ï¼š

---

## âœ… å½“å‰å®¢æˆ·ç«¯è¡Œä¸ºåˆ†æ

### 1. **å®¢æˆ·ç«¯æ­£å¸¸è¿è¡Œæ—¶**

* ä½¿ç”¨ `gRPC åŒå‘æµï¼ˆConnectï¼‰` å»ºç«‹è¿æ¥ï¼›
* æ³¨å†Œè‡ªèº« `clientId`ï¼›
* é€šè¿‡å¿ƒè·³åŒ…ä¿æŒè¿æ¥æ´»è·ƒï¼›
* æŒç»­ç›‘å¬æœåŠ¡ç«¯æ¨é€ `ServerMessage`ï¼Œåªè¦è¿æ¥ä¸æ–­ï¼ŒæœåŠ¡ç«¯å¯éšæ—¶ `onNext()` æ¨é€æ•°æ®ã€‚

---

### 2. **å®¢æˆ·ç«¯æ„å¤–æ–­å¼€ï¼ˆæ–­ç½‘ã€å´©æºƒã€é‡å¯ï¼‰**

* æœåŠ¡ç«¯ä¼šæ”¶åˆ° `onError()` æˆ– `onCompleted()`ï¼Œè°ƒç”¨ `connectionManager.remove(clientId)` è¿›è¡Œæ¸…ç†ï¼›
* å®¢æˆ·ç«¯å†…éƒ¨çš„ `onError()` ä¼šè¢«è§¦å‘ï¼Œè°ƒç”¨ `reconnectWithBackoff()`ï¼›
* 3 ç§’åè‡ªåŠ¨é‡æ–°è¿æ¥ï¼Œå¹¶é‡æ–°æ³¨å†Œ clientId + å¼€å§‹å¿ƒè·³ï¼›
* å¦‚æœæœåŠ¡ç«¯åœ¨ Redis æˆ–å…±äº«æ³¨å†Œè¡¨ä¸­ä¹Ÿæ›´æ–°äº†è¿æ¥çŠ¶æ€ï¼Œå°±å¯ä»¥ç»§ç»­æ­£å¸¸æ¨é€ã€‚

---

## æ˜¯å¦èƒ½ä¿è¯**æ¨é€ä¸ä¸­æ–­**ï¼Ÿ

| åœºæ™¯      | æ¨é€æ˜¯å¦å¯è¾¾ | è¯´æ˜                               |
| ------- | ------ | -------------------------------- |
| å®¢æˆ·ç«¯åœ¨çº¿   | âœ… å¯è¾¾   | ç›´æ¥é€šè¿‡å†…å­˜ä¸­çš„ `StreamObserver` æ¨é€     |
| å®¢æˆ·ç«¯æ‰çº¿   | âŒ ä¸å¯è¾¾  | æœåŠ¡ç«¯è¿æ¥å·²æ–­ï¼Œ`onNext()` ä¼šæŠ¥é”™           |
| å®¢æˆ·ç«¯é‡è¿æˆåŠŸ | âœ… æ¢å¤å¯è¾¾ | ä¼šé‡æ–°æ³¨å†Œï¼Œæ–°çš„è¿æ¥ä¼šå»ºç«‹æ–°çš„ `StreamObserver` |


## å¯é€‰å¢å¼ºï¼šåœ¨é‡è¿æ—¶è®©æœåŠ¡ç«¯æ„ŸçŸ¥

å¯åœ¨å®¢æˆ·ç«¯é‡è¿æ—¶å‘ `ReconnectRequest`ï¼š

```protobuf
message ClientMessage {
  oneof payload {
    RegisterRequest register = 1;
    Heartbeat heartbeat = 2;
    ReconnectRequest reconnect = 3;
  }
}
message ReconnectRequest {
  string client_id = 1;
  string lastSessionId = 2;
}
```

### å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´éœ€è¦ä¼ é€å¤šç§ç±»å‹çš„æ¶ˆæ¯
ä½ å¯ä»¥æ‰©å±• proto çš„ç»“æ„ï¼ŒåŠ å…¥å¤šä¸ªæ¶ˆæ¯ç±»å‹ï¼š

``` 
message ServerMessage {
  oneof payload {
    TextMessage text = 1;
    FileMessage file = 2;
    NotifyEvent event = 3;
  }
}

message TextMessage {
  string content = 1;
}

message FileMessage {
  string fileName = 1;
  bytes content = 2;
  int32 sequence = 3;
  bool isLast = 4;
}

message NotifyEvent {
  string type = 1; // online/offline/update
  string details = 2;
}

```

å½“å‰éœ€æ±‚æ˜¯ **å‘å®¢æˆ·ç«¯åŒæ­¥æ–‡ä»¶**ï¼Œé‚£ç°æœ‰çš„è®¾è®¡ï¼ˆ`ServerMessage.message` ä»…ä¸º `string`ï¼‰**ä¸é€‚åˆä¼ è¾“å¤§æ–‡ä»¶æˆ–äºŒè¿›åˆ¶å†…å®¹**ï¼Œä½ å¯ä»¥è€ƒè™‘ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–ï¼š

---

## æ–‡ä»¶æµå¼ä¼ è¾“ä¸æ¨é€æ§åˆ¶åˆ†ç¦»

| é€šä¿¡ç±»å‹      | å»ºè®® gRPC æ¥å£                          | é€šé“ç±»å‹     |
| --------- | ----------------------------------- | -------- |
| æ§åˆ¶å‘½ä»¤ / å¿ƒè·³ | `Connect(stream)`                   | é•¿è¿æ¥åŒå‘æµ   |
| æ–‡ä»¶æ•°æ®æµ     | `TransferFile(stream FileChunk)`    | ç‹¬ç«‹æµå¼ RPC |
| æ¨é€æ–‡ä»¶é€šçŸ¥æ¶ˆæ¯  | åœ¨ `ServerMessage` ä¸­æ–°å¢ `FileInfo` ç±»å‹ | ä½¿ç”¨ç°æœ‰è¿æ¥   |

---

##  æˆ‘æ¨èä½ è¿›è¡Œä»¥ä¸‹è°ƒæ•´ï¼š

### 1. `ServerMessage` æ‰©å±•ä¸ºå¤šç±»å‹æ”¯æŒï¼ˆç”¨äºé€šçŸ¥æ–‡ä»¶æ¨é€ï¼‰

```proto
message ServerMessage {
  oneof payload {
    TextMessage text = 1;
    FileNotice file_notice = 2;
  }
}

message TextMessage {
  string content = 1;
}

message FileNotice {
  string file_name = 1;
  int64 file_size = 2;
  string file_id = 3; // ç”¨äºåç»­è·å–è¯¥æ–‡ä»¶
}
```

æœåŠ¡ç«¯å¯ä»¥å‘é€ï¼š

```java
ServerMessage.newBuilder()
    .setFileNotice(FileNotice.newBuilder()
        .setFileName("doc.pdf")
        .setFileSize(102400)
        .setFileId("uuid-1234"))
    .build();
```

---

### 2. æ–°å¢æ–‡ä»¶ä¼ è¾“æ¥å£ï¼ˆå®¢æˆ·ç«¯è°ƒç”¨ï¼‰

```proto
service FileService {
  rpc DownloadFile(FileRequest) returns (stream FileChunk);
}

message FileRequest {
  string file_id = 1;
}

message FileChunk {
  bytes content = 1;
  int32 sequence = 2;
  bool is_last = 3;
}
```

æœåŠ¡ç«¯æŒ‰å—ä¼ è¾“æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯æ ¹æ® `file_id` è°ƒç”¨ `DownloadFile(file_id)` è·å–çœŸæ­£çš„äºŒè¿›åˆ¶å†…å®¹ã€‚

---

### 3. é€šä¿¡æµç¨‹å›¾ç¤ºä¾‹

```
æœåŠ¡ç«¯             ä¸­å¿ƒèŠ‚ç‚¹               å®¢æˆ·ç«¯
  â”‚                    â”‚                    â”‚
  â”‚ â”€â”€ æ¨é€ FileNotice â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º    â”‚
  â”‚                    â”‚         onNext: æ”¶åˆ° file_id
  â”‚                    â”‚                    â”‚
  â”‚                    â”‚ â—„â”€â”€ ä¸‹è½½æ–‡ä»¶è¯·æ±‚ â”€â”€â”¤
  â”‚ â—„â”€ æ–‡ä»¶å—ä¼ è¾“ï¼ˆæµå¼ï¼‰â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

###  ä¼˜ç‚¹ï¼š

* ğŸ§© æ–‡ä»¶æ•°æ®é€šè¿‡ç‹¬ç«‹æµä¼ è¾“ï¼Œä¸å¹²æ‰°æ§åˆ¶æµ
* ğŸ§  å¯å®ç°å¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ ã€å‹ç¼©ã€æ ¡éªŒ
* ğŸ§¼ æ§åˆ¶æ¶ˆæ¯è½»é‡ï¼Œç»“æ„æ¸…æ™°
* ğŸ”„ æ–‡ä»¶å¯ç¼“å­˜ + å»é‡ï¼ˆæœåŠ¡ç«¯å¯å­˜ OSSï¼Œå†æä¾›ä¸´æ—¶ URLï¼‰

## â“ ä¸ºä»€ä¹ˆä¸ç›´æ¥æ¨é€æ–‡ä»¶æµï¼Œè€Œæ˜¯å…ˆé€šçŸ¥å®¢æˆ·ç«¯å†ç”±å®¢æˆ·ç«¯æ‹‰å–ï¼Ÿ

è¿™æ˜¯åˆ†å¸ƒå¼é€šä¿¡ä¸­**æ¨æ‹‰æ¨¡å¼çš„æ ¸å¿ƒè®¾è®¡æƒè¡¡**ã€‚

---

## âœ… å½“å‰é‡‡ç”¨â€œé€šçŸ¥ + æ‹‰å–â€çš„æ–¹æ¡ˆ

> æœåŠ¡ç«¯é€šè¿‡ `ServerMessage` æ¨é€ `FileNotice`ï¼ˆè½»é‡é€šçŸ¥ï¼‰ï¼Œå®¢æˆ·ç«¯éšåé€šè¿‡ `DownloadFile(fileId)` ä¸»åŠ¨æ‹‰å–ã€‚

---

## âœ… è¿™ä¹ˆåšçš„å¥½å¤„ï¼š

### 1. **æµé‡ç”±å®¢æˆ·ç«¯æ§åˆ¶ï¼Œæ›´å®‰å…¨**

* å®¢æˆ·ç«¯å†³å®šæ˜¯å¦/ä½•æ—¶ä¸‹è½½ï¼Œé¿å…è¿‡è½½ï¼ˆå¦‚ç½‘ç»œæ…¢/ç£ç›˜æ»¡ï¼‰
* å®¢æˆ·ç«¯å¯ä»¥é™é€Ÿã€æ–­ç‚¹ç»­ä¼ ã€å¤±è´¥é‡è¯•

### 2. **è¿æ¥ç®€å•ã€èŒè´£æ¸…æ™°**

* æ¨é€é€šé“ï¼ˆConnectï¼‰ç”¨äºé€šçŸ¥
* æ–‡ä»¶é€šé“ï¼ˆDownloadFileï¼‰ç”¨äºä¼ è¾“
* æ˜“äºåŒºåˆ†é—®é¢˜æ¥æºã€ç»Ÿè®¡æ€§èƒ½

### 3. **æ–‡ä»¶æµå¯å¼‚æ­¥åˆ†å‘ / å¤šé€šé“å¤„ç†**

* å®¢æˆ·ç«¯å¯ä»¥åœ¨å¦ä¸€ä¸ªçº¿ç¨‹æˆ–ç»„ä»¶ä¸­å¹¶å‘å¤„ç†æ–‡ä»¶æ‹‰å–
* æ”¯æŒ CDN åŠ é€Ÿ/OSS ä¸´æ—¶ URL æ‹‰å–

### 4. **æœåŠ¡ç«¯èµ„æºé‡Šæ”¾æ›´åŠæ—¶**

* `FileServiceImpl` å®Œæˆä¼ è¾“åå¯ä»¥ç«‹å³ `onCompleted()`ï¼Œæ— éœ€ç»´æŒé•¿è¿æ¥
* ä¸€å°æœåŠ¡å¯ä»¥é«˜æ•ˆåŒæ—¶æœåŠ¡å¤šä¸ªå®¢æˆ·ç«¯

---

## âŒ å¦‚æœæ”¹ä¸ºâ€œæœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ–‡ä»¶æµâ€ä¼šé‡åˆ°çš„é—®é¢˜ï¼š

### 1. **æœåŠ¡ç«¯éš¾ä»¥ç¡®å®šå®¢æˆ·ç«¯ä½•æ—¶å‡†å¤‡å¥½**

* æœåŠ¡ç«¯å¯èƒ½æ¨è¿‡å»æ—¶ï¼Œå®¢æˆ·ç«¯æ ¹æœ¬æ²¡å‡†å¤‡å¥½å†™å…¥æ–‡ä»¶

### 2. **æ— æ³•ç»†ç²’åº¦æ§åˆ¶å¹¶å‘**

* å®¢æˆ·ç«¯å¯èƒ½åŒæ—¶æ”¶åˆ°å¤šä¸ªå¤§æ–‡ä»¶æµï¼Œå æ»¡å¸¦å®½å’Œå†…å­˜

### 3. **é”™è¯¯å¤„ç†å¤æ‚**

* å¦‚æœæœåŠ¡ç«¯æ¨æ–‡ä»¶å¤±è´¥ï¼Œéœ€è¦å¤æ‚çš„ç¡®è®¤/é‡è¯•æœºåˆ¶
* å®¢æˆ·ç«¯æ–­å¼€æ—¶ï¼ŒæœåŠ¡ç«¯çš„ `onNext()` ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé€»è¾‘ä¸ä¼˜é›…

### 4. **æ–­ç‚¹ç»­ä¼ ã€ç¡®è®¤æœºåˆ¶å¤æ‚**

* æœåŠ¡ç«¯éœ€è¦ç»´æŠ¤çŠ¶æ€ï¼šå“ªäº›å®¢æˆ·ç«¯æ”¶äº†å“ªäº›å—ï¼Œä¼ åˆ°ç¬¬å‡ å—ï¼Œç¡®è®¤äº†å—ï¼Ÿ

---

## âœ… æ¨æ‹‰æ¨¡å¼çš„æ€»ç»“ç±»æ¯”ï¼š

| æ¨¡å¼            | ç±»æ¯”              | ä¼˜ç‚¹      | ç¼ºç‚¹         |
| ------------- | --------------- | ------- | ---------- |
| æœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ–‡ä»¶æµ    | å¿«é€’å‘˜ç›´æ¥æŠŠå¤§ç®±å­é€ä¸Šé—¨    | æ— éœ€å®¢æˆ·ç«¯å‘èµ· | å®¢æˆ·ç«¯æ²¡å‡†å¤‡å¥½å¯èƒ½å´© |
| æœåŠ¡ç«¯é€šçŸ¥ + å®¢æˆ·ç«¯æ‹‰å– | é€šçŸ¥ä½ æœ‰å¿«é€’ï¼Œè‡ªå·±å†³å®šä½•æ—¶å»æ‹¿ | å®¢æˆ·ç«¯æ§åˆ¶èŠ‚å¥ | å®ç°ç¨å¾®å¤æ‚ç‚¹    |

---

## âœ… æ‰€ä»¥ï¼Œé™¤éä½ æœ‰è¿™äº›å¼ºçƒˆéœ€æ±‚ï¼š

* âœ… æ‰€æœ‰å®¢æˆ·ç«¯å®æ—¶ã€å¼ºåˆ¶æ¥æ”¶æ¨é€
* âœ… ç½‘ç»œç¯å¢ƒéå¸¸å¥½ã€å¯æ§ï¼ˆå¦‚å†…ç½‘ï¼‰
* âœ… æœåŠ¡ç«¯å…·æœ‰è°ƒåº¦æƒä¸”è´Ÿè½½è¾ƒå°

å¦åˆ™ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼š

> **ä½¿ç”¨é€šçŸ¥ + å®¢æˆ·ç«¯æ‹‰å–çš„æ¨¡å¼ï¼Œæ˜¯ç›®å‰ä¸»æµã€å¥å£®ã€æ‰©å±•æ€§å¼ºçš„è®¾è®¡ã€‚**

---